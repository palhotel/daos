//类似glibc
void io_hlt(void);
void io_cli(void);
void io_out8(int port, int data);
int io_load_eflags(void);
void io_store_eflags(int eflags);
void write_mem8(int addr, int data);

//类似内核函数,函数必须定义在主函数之后，否则找不到入口地址。const变量也会影响入口地址
void init_palette(void);
void set_palette(int start, int end, unsigned char *rgb);
//类似于GDI
void boxfill8(unsigned char* vram, int xsize, unsigned char c, int x0, int y0, int x1, int y1);

struct font_index_desc
{
    int bitmap_index;  // 字形位图数据的索引
    int adv_w;         // 字形的宽度
    int box_w;         // 字形的实际宽度
    int box_h;         // 字形的实际高度
    int ofs_x;         // 字形相对于原点的水平偏移
    int ofs_y;         // 字形相对于基线的垂直偏移
};
extern int ascii_bitmap[];
extern struct font_index_desc glyph_dsc[];
void putfont8(char* vram, int xsize, int x, int y, char c, int* pbitmaps, int ascii);
void putstring(char* vram, int xsize, int x, int y, char c, int* pbitmaps, char* str, int len);


void _DAOS_Main(void) {
  int i;
  char *p;
  short *binfo_scrnx, *binfo_scrny;
  int *binfo_vram;
  init_palette();
  //boot info
  //0xa0000是左上角的像素点
  binfo_scrnx = (short*)0xff4;
  binfo_scrny = (short*)0xff6;
  binfo_vram = (int*)0xff8;

  int xsize = *binfo_scrnx;
  int ysize = *binfo_scrny;
  unsigned char* vram = (char*)*binfo_vram;

  //先刷一个背景色 320*200
  boxfill8(vram, xsize, 15, 0, 0, 320, 200);
  //画一些东西
  boxfill8(vram, 320, 3, 150, 90, 170, 110);
  boxfill8(vram, 320, 5, 120, 90, 140, 110);
  boxfill8(vram, 320, 7, 135, 120, 155, 140);

  //绘制字符
  putfont8(vram, 320, 30, 100, 13, ascii_bitmap, 'D'); 
  putfont8(vram, 320, 40, 100, 13, ascii_bitmap, 'C'); 
  putfont8(vram, 320, 50, 100, 13, ascii_bitmap, 'T');
  putfont8(vram, 320, 60, 100, 13, ascii_bitmap, 'v');
  putfont8(vram, 320, 70, 100, 13, ascii_bitmap, '5');
  putfont8(vram, 320, 80, 100, 13, ascii_bitmap, ',');
  putfont8(vram, 320, 90, 100, 13, ascii_bitmap, 'D');
  putfont8(vram, 320, 100, 100, 13, ascii_bitmap, 'A');
  putfont8(vram, 320, 110, 100, 13, ascii_bitmap, 'Z');
  

  putstring(vram, 320, 30, 50, 13, ascii_bitmap, "NB\0", 2); //栈或者参数长度有限制
  for(;;){
    io_hlt();
  }
}

void init_palette(void){
  static unsigned char table_rgb[16*3] = {
    0x00, 0x00, 0x00,
    0x66, 0x00, 0x00,
    0xcc, 0x00, 0x00,
    0xff, 0x00, 0x00,
    0x00, 0x66, 0x00,
    0x00, 0xcc, 0x00,
    0x00, 0xff, 0x00,
    0x00, 0x00, 0x66,
    0x00, 0x00, 0xcc,
    0x00, 0x00, 0xff,
    0xcc, 0xcc, 0x00,
    0xff, 0xff, 0x00,
    0xcc, 0x00, 0xcc,
    0xff, 0x00, 0xff,
    0x00, 0xff, 0xff,
    0xff, 0xff, 0xff,
  };
  set_palette(0, 15, table_rgb);
}

void set_palette(int start, int end, unsigned char *rgb){
  int i, eflags;
  eflags = io_load_eflags(); //记录中断许可标志的值
  io_cli();//中断许可标志设置为0
  io_out8(0x3c8, start); //将想要设定的调色板号码写入0x3c8，然后将rgb写入0x3c9
  for(i = start; i <= end; i++){
    io_out8(0x3c9, rgb[0]/4);
    io_out8(0x3c9, rgb[1]/4);
    io_out8(0x3c9, rgb[2]/4);
    rgb += 3;
  }
  io_store_eflags(eflags);
}

void boxfill8(unsigned char* vram, int xsize, unsigned char c, int x0, int y0, int x1, int y1){
  int x, y;
  for(y = y0; y <= y1; y++){
    for (x = x0; x<=x1; x++){
      vram[y  * xsize + x] = c;
    }
  }
}

int ascii_bitmap[] = {
    /* U+0020 ' ' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    /* U+0021 '!' */
    0x0000, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0000, 0x0800, 0x0000, 0x0000, 0x0000,
    /* U+0022 '"' */
    0x0000, 0x1200, 0x1200, 0x1200, 0x1200, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    /* U+0023 '#' */
    0x0000, 0x0440, 0x0440, 0x0440, 0x0880, 0x3FE0, 0x0880, 0x0880, 0x0880, 0x3FE0, 0x1100, 0x1100, 0x1100, 0x0000, 0x0000, 0x0000,
    /* U+0024 '$' */
    0x0200, 0x0780, 0x0A40, 0x1240, 0x1200, 0x1200, 0x0E00, 0x0380, 0x0240, 0x0240, 0x1240, 0x0A80, 0x0700, 0x0200, 0x0000, 0x0000,
    /* U+0025 '%' */
    0x0000, 0x0E10, 0x1120, 0x1120, 0x1140, 0x1140, 0x0E40, 0x009C, 0x00A2, 0x0122, 0x0122, 0x0222, 0x021C, 0x0000, 0x0000, 0x0000,
    /* U+0026 '&' */
    0x0000, 0x0700, 0x0880, 0x0880, 0x0880, 0x0500, 0x0600, 0x0A00, 0x1110, 0x10A0, 0x1040, 0x08A0, 0x0710, 0x0000, 0x0000, 0x0000,
    /* U+0027 ''' */
    0x0000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    /* U+0028 '(' */
    0x0000, 0x0400, 0x0800, 0x0800, 0x0800, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0800, 0x0800, 0x0800, 0x0400,
    /* U+0029 ')' */
    0x0000, 0x1000, 0x0800, 0x0800, 0x0800, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0400, 0x0800, 0x0800, 0x0800, 0x1000,
    /* U+002A '*' */
    0x0000, 0x0800, 0x3E00, 0x0800, 0x1400, 0x1400, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    /* U+002B '+' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0200, 0x0200, 0x0200, 0x1FC0, 0x0200, 0x0200, 0x0200, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    /* U+002C ',' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0800, 0x0800, 0x0800, 0x0000,
    /* U+002D '-' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x3C00, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    /* U+002E '.' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0800, 0x0000, 0x0000, 0x0000,
    /* U+002F '/' */
    0x0000, 0x0400, 0x0400, 0x0800, 0x0800, 0x0800, 0x0800, 0x1000, 0x1000, 0x1000, 0x1000, 0x2000, 0x2000, 0x0000, 0x0000, 0x0000,
    /* U+0030 '0' */
    0x0000, 0x0700, 0x0880, 0x1040, 0x1040, 0x1040, 0x1040, 0x1040, 0x1040, 0x1040, 0x1040, 0x0880, 0x0700, 0x0000, 0x0000, 0x0000,
    /* U+0031 '1' */
    0x0000, 0x0100, 0x0300, 0x0500, 0x0900, 0x0100, 0x0100, 0x0100, 0x0100, 0x0100, 0x0100, 0x0100, 0x0100, 0x0000, 0x0000, 0x0000,
    /* U+0032 '2' */
    0x0000, 0x0780, 0x0880, 0x1040, 0x0040, 0x0040, 0x0080, 0x0080, 0x0100, 0x0200, 0x0400, 0x0800, 0x1FC0, 0x0000, 0x0000, 0x0000,
    /* U+0033 '3' */
    0x0000, 0x0700, 0x0880, 0x1080, 0x0080, 0x0180, 0x0700, 0x0080, 0x0040, 0x0040, 0x1040, 0x1880, 0x0700, 0x0000, 0x0000, 0x0000,
    /* U+0034 '4' */
    0x0000, 0x0080, 0x0180, 0x0280, 0x0480, 0x0480, 0x0880, 0x1080, 0x2080, 0x3FC0, 0x0080, 0x0080, 0x0080, 0x0000, 0x0000, 0x0000,
    /* U+0035 '5' */
    0x0000, 0x0FC0, 0x0800, 0x0800, 0x1000, 0x1F00, 0x1080, 0x0040, 0x0040, 0x0040, 0x1040, 0x0880, 0x0700, 0x0000, 0x0000, 0x0000,
    /* U+0036 '6' */
    0x0000, 0x0700, 0x0880, 0x1040, 0x1000, 0x1700, 0x1880, 0x1040, 0x1040, 0x1040, 0x1040, 0x0880, 0x0700, 0x0000, 0x0000, 0x0000,
    /* U+0037 '7' */
    0x0000, 0x0FC0, 0x0040, 0x0080, 0x0080, 0x0100, 0x0100, 0x0100, 0x0100, 0x0200, 0x0200, 0x0200, 0x0200, 0x0000, 0x0000, 0x0000,
    /* U+0038 '8' */
    0x0000, 0x0700, 0x0880, 0x1040, 0x1040, 0x0880, 0x0700, 0x0880, 0x1040, 0x1040, 0x1040, 0x0880, 0x0700, 0x0000, 0x0000, 0x0000,
    /* U+0039 '9' */
    0x0000, 0x0700, 0x0880, 0x1040, 0x1040, 0x1040, 0x1040, 0x08C0, 0x0740, 0x0040, 0x1040, 0x0880, 0x0700, 0x0000, 0x0000, 0x0000,
    /* U+003A ':' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x1000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x1000, 0x0000, 0x0000, 0x0000,
    /* U+003B ';' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x1000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x1000, 0x1000, 0x1000, 0x0000,
    /* U+003C '<' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0040, 0x0380, 0x0C00, 0x1000, 0x0C00, 0x0380, 0x0040, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    /* U+003D '=' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x1FC0, 0x0000, 0x0000, 0x0000, 0x1FC0, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    /* U+003E '>' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x1000, 0x0E00, 0x0180, 0x0040, 0x0180, 0x0E00, 0x1000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    /* U+003F '?' */
    0x0000, 0x0700, 0x0880, 0x1040, 0x1040, 0x0040, 0x0080, 0x0100, 0x0200, 0x0200, 0x0200, 0x0000, 0x0200, 0x0000, 0x0000, 0x0000,
    /* U+0040 '@' */
    0x0000, 0x00FC, 0x0303, 0x0400, 0x0874, 0x088C, 0x1104, 0x1204, 0x1208, 0x1208, 0x1208, 0x1119, 0x08EE, 0x0400, 0x0301, 0x00FE,
    /* U+0041 'A' */
    0x0000, 0x0100, 0x0280, 0x0280, 0x0280, 0x0440, 0x0440, 0x0440, 0x0FE0, 0x0820, 0x0820, 0x1010, 0x1010, 0x0000, 0x0000, 0x0000,
    /* U+0042 'B' */
    0x0000, 0x1FC0, 0x1020, 0x1010, 0x1010, 0x1020, 0x1FC0, 0x1020, 0x1010, 0x1010, 0x1010, 0x1020, 0x1FC0, 0x0000, 0x0000, 0x0000,
    /* U+0043 'C' */
    0x0000, 0x03E0, 0x0410, 0x0808, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0808, 0x0410, 0x03E0, 0x0000, 0x0000, 0x0000,
    /* U+0044 'D' */
    0x0000, 0x1FC0, 0x1020, 0x1010, 0x1008, 0x1008, 0x1008, 0x1008, 0x1008, 0x1008, 0x1010, 0x1020, 0x1FC0, 0x0000, 0x0000, 0x0000,
    /* U+0045 'E' */
    0x0000, 0x1FF0, 0x1000, 0x1000, 0x1000, 0x1000, 0x1FE0, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1FF0, 0x0000, 0x0000, 0x0000,
    /* U+0046 'F' */
    0x0000, 0x1FE0, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1FC0, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0000, 0x0000, 0x0000,
    /* U+0047 'G' */
    0x0000, 0x03C0, 0x0420, 0x0810, 0x1000, 0x1000, 0x1000, 0x10F8, 0x1008, 0x1008, 0x0810, 0x0420, 0x03C0, 0x0000, 0x0000, 0x0000,
    /* U+0048 'H' */
    0x0000, 0x1010, 0x1010, 0x1010, 0x1010, 0x1010, 0x1FF0, 0x1010, 0x1010, 0x1010, 0x1010, 0x1010, 0x1010, 0x0000, 0x0000, 0x0000,
    /* U+0049 'I' */
    0x0000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0000, 0x0000, 0x0000,
    /* U+004A 'J' */
    0x0000, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x0080, 0x1080, 0x1080, 0x1080, 0x0F00, 0x0000, 0x0000, 0x0000,
    /* U+004B 'K' */
    0x0000, 0x1010, 0x1020, 0x1040, 0x1080, 0x1100, 0x1300, 0x1500, 0x1880, 0x1040, 0x1040, 0x1020, 0x1010, 0x0000, 0x0000, 0x0000,
    /* U+004C 'L' */
    0x0000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1FC0, 0x0000, 0x0000, 0x0000,
    /* U+004D 'M' */
    0x0000, 0x1004, 0x180C, 0x180C, 0x1414, 0x1414, 0x1224, 0x1224, 0x1144, 0x1144, 0x1144, 0x1084, 0x1084, 0x0000, 0x0000, 0x0000,
    /* U+004E 'N' */
    0x0000, 0x1010, 0x1810, 0x1410, 0x1410, 0x1210, 0x1110, 0x1110, 0x1090, 0x1050, 0x1050, 0x1030, 0x1010, 0x0000, 0x0000, 0x0000,
    /* U+004F 'O' */
    0x0000, 0x03C0, 0x0420, 0x0810, 0x1008, 0x1008, 0x1008, 0x1008, 0x1008, 0x1008, 0x0810, 0x0420, 0x03C0, 0x0000, 0x0000, 0x0000,
    /* U+0050 'P' */
    0x0000, 0x1FC0, 0x1020, 0x1010, 0x1010, 0x1010, 0x1020, 0x1FC0, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0000, 0x0000, 0x0000,
    /* U+0051 'Q' */
    0x0000, 0x03C0, 0x0420, 0x0810, 0x1008, 0x1008, 0x1008, 0x1008, 0x1008, 0x1008, 0x08D8, 0x0430, 0x03D8, 0x0000, 0x0000, 0x0000,
    /* U+0052 'R' */
    0x0000, 0x1FC0, 0x1020, 0x1010, 0x1010, 0x1010, 0x1020, 0x1FC0, 0x1080, 0x1040, 0x1040, 0x1020, 0x1010, 0x0000, 0x0000, 0x0000,
    /* U+0053 'S' */
    0x0000, 0x07C0, 0x0820, 0x1010, 0x1000, 0x0800, 0x0700, 0x00E0, 0x0010, 0x0010, 0x1010, 0x0820, 0x07C0, 0x0000, 0x0000, 0x0000,
    /* U+0054 'T' */
    0x0000, 0x3FE0, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0000, 0x0000, 0x0000,
    /* U+0055 'U' */
    0x0000, 0x1010, 0x1010, 0x1010, 0x1010, 0x1010, 0x1010, 0x1010, 0x1010, 0x1010, 0x1010, 0x0820, 0x07C0, 0x0000, 0x0000, 0x0000,
    /* U+0056 'V' */
    0x0000, 0x1010, 0x1010, 0x0820, 0x0820, 0x0820, 0x0440, 0x0440, 0x0440, 0x0280, 0x0280, 0x0100, 0x0100, 0x0000, 0x0000, 0x0000,
    /* U+0057 'W' */
    0x0000, 0x2040, 0x20A0, 0x10A1, 0x10A1, 0x1111, 0x1111, 0x0912, 0x0A0A, 0x0A0A, 0x0A0A, 0x0404, 0x0404, 0x0000, 0x0000, 0x0000,
    /* U+0058 'X' */
    0x0000, 0x1010, 0x0820, 0x0440, 0x0440, 0x0280, 0x0100, 0x0280, 0x0440, 0x0440, 0x0820, 0x1010, 0x2008, 0x0000, 0x0000, 0x0000,
    /* U+0059 'Y' */
    0x0000, 0x2020, 0x1040, 0x1040, 0x0880, 0x0500, 0x0500, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0200, 0x0000, 0x0000, 0x0000,
    /* U+005A 'Z' */
    0x0000, 0x1FE0, 0x0040, 0x0080, 0x0080, 0x0100, 0x0200, 0x0200, 0x0400, 0x0800, 0x0800, 0x1000, 0x3FE0, 0x0000, 0x0000, 0x0000,
    /* U+005B '[' */
    0x0000, 0x1C00, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1C00,
    /* U+005C '\' */
    0x0000, 0x2000, 0x2000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0800, 0x0800, 0x0800, 0x0800, 0x0400, 0x0400, 0x0000, 0x0000, 0x0000,
    /* U+005D ']' */
    0x0000, 0x3800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x3800,
    /* U+005E '^' */
    0x0000, 0x0400, 0x0A00, 0x0A00, 0x1100, 0x1100, 0x2080, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    /* U+005F '_' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x3FE0,
    /* U+0060 '`' */
    0x0000, 0x1000, 0x0800, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
    /* U+0061 'a' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0780, 0x0840, 0x1040, 0x01C0, 0x0E40, 0x1040, 0x1040, 0x10C0, 0x0F40, 0x0000, 0x0000, 0x0000,
    /* U+0062 'b' */
    0x0000, 0x1000, 0x1000, 0x1000, 0x1700, 0x1880, 0x1040, 0x1040, 0x1040, 0x1040, 0x1040, 0x1880, 0x1700, 0x0000, 0x0000, 0x0000,
    /* U+0063 'c' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0700, 0x0880, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0880, 0x0700, 0x0000, 0x0000, 0x0000,
    /* U+0064 'd' */
    0x0000, 0x0040, 0x0040, 0x0040, 0x0740, 0x08C0, 0x1040, 0x1040, 0x1040, 0x1040, 0x1040, 0x08C0, 0x0740, 0x0000, 0x0000, 0x0000,
    /* U+0065 'e' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0700, 0x0880, 0x1040, 0x1040, 0x1FC0, 0x1000, 0x1040, 0x0880, 0x0700, 0x0000, 0x0000, 0x0000,
    /* U+0066 'f' */
    0x0000, 0x0C00, 0x1000, 0x1000, 0x3C00, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0000, 0x0000, 0x0000,
    /* U+0067 'g' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0740, 0x08C0, 0x1040, 0x1040, 0x1040, 0x1040, 0x1040, 0x08C0, 0x0740, 0x0040, 0x1080, 0x0F00,
    /* U+0068 'h' */
    0x0000, 0x1000, 0x1000, 0x1000, 0x1700, 0x1880, 0x1080, 0x1080, 0x1080, 0x1080, 0x1080, 0x1080, 0x1080, 0x0000, 0x0000, 0x0000,
    /* U+0069 'i' */
    0x0000, 0x1000, 0x0000, 0x0000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0000, 0x0000, 0x0000,
    /* U+006A 'j' */
    0x0000, 0x1000, 0x0000, 0x0000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x6000,
    /* U+006B 'k' */
    0x0000, 0x1000, 0x1000, 0x1000, 0x1040, 0x1080, 0x1100, 0x1200, 0x1600, 0x1900, 0x1100, 0x1080, 0x1040, 0x0000, 0x0000, 0x0000,
    /* U+006C 'l' */
    0x0000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0000, 0x0000, 0x0000,
    /* U+006D 'm' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x1738, 0x18C4, 0x1084, 0x1084, 0x1084, 0x1084, 0x1084, 0x1084, 0x1084, 0x0000, 0x0000, 0x0000,
    /* U+006E 'n' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x1700, 0x1880, 0x1080, 0x1080, 0x1080, 0x1080, 0x1080, 0x1080, 0x1080, 0x0000, 0x0000, 0x0000,
    /* U+006F 'o' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0700, 0x0880, 0x1040, 0x1040, 0x1040, 0x1040, 0x1040, 0x0880, 0x0700, 0x0000, 0x0000, 0x0000,
    /* U+0070 'p' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x1700, 0x1880, 0x1040, 0x1040, 0x1040, 0x1040, 0x1040, 0x1880, 0x1F00, 0x1000, 0x1000, 0x1000,
    /* U+0071 'q' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0740, 0x08C0, 0x1040, 0x1040, 0x1040, 0x1040, 0x1040, 0x08C0, 0x0740, 0x0040, 0x0040, 0x0040,
    /* U+0072 'r' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x1600, 0x1800, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x0000, 0x0000, 0x0000,
    /* U+0073 's' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0F00, 0x1080, 0x1000, 0x1000, 0x0F00, 0x0080, 0x0080, 0x1080, 0x0F00, 0x0000, 0x0000, 0x0000,
    /* U+0074 't' */
    0x0000, 0x0000, 0x1000, 0x1000, 0x3C00, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1C00, 0x0000, 0x0000, 0x0000,
    /* U+0075 'u' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x1080, 0x1080, 0x1080, 0x1080, 0x1080, 0x1080, 0x1080, 0x1180, 0x0E80, 0x0000, 0x0000, 0x0000,
    /* U+0076 'v' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x4100, 0x4100, 0x2200, 0x2200, 0x1400, 0x1400, 0x1400, 0x0800, 0x0800, 0x0000, 0x0000, 0x0000,
    /* U+0077 'w' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x2108, 0x2108, 0x1290, 0x1290, 0x1450, 0x1450, 0x1450, 0x0820, 0x0820, 0x0000, 0x0000, 0x0000,
    /* U+0078 'x' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x2080, 0x1100, 0x0A00, 0x0A00, 0x0400, 0x0A00, 0x0A00, 0x1100, 0x2080, 0x0000, 0x0000, 0x0000,
    /* U+0079 'y' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x4100, 0x4100, 0x4200, 0x2200, 0x2200, 0x1400, 0x1400, 0x1400, 0x0C00, 0x0800, 0x0800, 0x3000,
    /* U+007A 'z' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x3F80, 0x0100, 0x0200, 0x0200, 0x0400, 0x0800, 0x0800, 0x1000, 0x3F80, 0x0000, 0x0000, 0x0000,
    /* U+007B '{' */
    0x0000, 0x0600, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x3000, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0600,
    /* U+007C '|' */
    0x0000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000, 0x1000,
    /* U+007D '}' */
    0x0000, 0x3000, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0600, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x0800, 0x3000,
    /* U+007E '~' */
    0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x1C40, 0x2380, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
};

//绘制一个字符，颜色c。
void putfont8(char *vram, int xsize, int x, int y, char c, int* pbitmaps, int ascii){
  int i;
  int oneline = 0;

  int idx = ascii - 0x20;
  int* font = pbitmaps + 16*idx;
  
  for (i = 0; i < 16; i++){
    oneline = font[i];
    for(int j = 15; j >= 0; j--){
      if( ((oneline >> j) & 1) != 0){
        vram[(y + i) * xsize + x - j] = c; //j from 15 to 0, so - j ?
      }
    }
  }
}
void putstring(char* vram, int xsize, int x, int y, char c, int* pbitmaps, char* str, int len){
  int fontsize = 10;
  for(int i = 0; i < len; i++){
    putfont8(vram, xsize, x + fontsize * i, y, c, pbitmaps, str[i]);
  }
}
